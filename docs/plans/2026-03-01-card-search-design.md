# 卡片化结果筛选设计

## 背景

当前提示词库的主要问题不是“搜不到”，而是“搜到了之后难以快速筛选、难以判断哪条最好”。用户在结果列表中需要频繁进入详情、来回比较，决策成本高。

本轮设计目标是降低单条结果的判断成本，让用户在列表层完成第一轮筛选，并通过右侧详情区完成第二轮确认。

## 设计目标

- 以缩略图为主视觉，提高浏览效率
- 在列表层直接暴露足够的决策信息
- 通过快速筛选与多维排序减少手动比较次数
- 让右侧详情区承接深度确认，而不是弹窗打断

## 方案结论

采用“缩略图主导的卡片墙 + 右侧详情区联动”的布局。

结果区改为卡片模式，缩略图作为卡片主视觉。用户单击卡片后，右侧详情区更新为当前记录的完整信息与拼装结果，不使用弹出式预览层。

## 卡片结构

每张卡片包含以下信息：

- 大缩略图
- 收藏状态
- 评分
- 标题
- 模型范围
- 3 到 5 个核心标签
- 命中原因
- 正向提示词摘要 1 到 2 行
- 更新时间

信息优先级如下：

1. 缩略图
2. 标题与模型范围
3. 标签与命中原因
4. 摘要与更新时间

## 交互设计

### 卡片区

- 单击卡片：右侧详情区更新
- 当前选中卡片：卡片边框和阴影高亮
- 悬停卡片：显示快捷操作

快捷操作包括：

- 收藏/取消收藏
- 复制正向提示词
- 加入检索节点

### 右侧详情区

右侧详情区承载完整确认信息，包括：

- 大图预览
- 标题
- 标签
- 模型范围
- 评分
- 更新时间
- 完整正负提示词
- 命中解释
- 模板/片段/变量信息
- 参数信息
- 版本信息

## 筛选设计

在结果区顶部加入快速筛选条，优先提供以下常用条件：

- 仅收藏
- 最近使用
- 高评分
- 有缩略图
- 有模板
- 当前模型可用
- 标签匹配度高

设计要求：

- 可叠加
- 当前已生效条件需可视化展示
- 一键清空全部筛选

## 排序设计

新增多维排序，并将“综合排序”设为默认：

- 综合排序
- 相关度
- 最近更新
- 最近使用
- 收藏优先
- 评分优先
- 使用次数

综合排序建议权重：

- 相关度 40%
- 最近使用 25%
- 收藏 15%
- 评分 20%

同时在界面中明确展示当前排序方式，避免用户不知道结果为何如此排序。

## 命中解释

每张卡片和右侧详情区都要提供命中解释，至少覆盖：

- 命中标题
- 命中标签
- 命中正向词
- 命中片段
- 命中模板变量

命中解释用于帮助用户快速判断该记录为什么排到当前位置，也为排序提供可解释性。

## 数据与接口要求

为支持卡片模式，列表接口返回字段需要从“轻量列表”扩展为“卡片摘要”：

- 基础字段：`id`, `title`, `updated_at`
- 视觉字段：`thumbnail_url` 或可推导的缩略图地址
- 筛选字段：`tags`, `model_scope`, `favorite`, `score`
- 摘要字段：`positive_preview`
- 命中字段：`match_reasons`
- 排序字段：`last_used_at`, `use_count`

如果现有数据库中没有 `last_used_at`、`use_count`，需要先补数据结构和写入逻辑，再启用对应排序。

## 实施优先级

### P1

- 卡片墙替换当前列表
- 单击卡片联动右侧详情区
- 快速筛选条
- 多维排序器

### P2

- 命中解释
- 快捷操作悬浮层
- 正向提示词摘要优化

### P3

- 使用次数与最近使用排序
- 更细粒度的标签匹配度

## 测试要求

- 卡片渲染在有图、无图、长标题、长标签情况下稳定
- 切换筛选条件后结果与计数正确
- 切换排序后结果顺序稳定
- 单击卡片时右侧详情区准确更新
- 选中态与 hover 操作不会相互冲突
- 命中解释字段为空时 UI 不报错

## 非目标

本轮不做以下内容：

- 弹出式大图预览
- 复杂对比模式
- 语义检索
- 远程协作与多用户共享
